{% extends "layout.html" %}

{% block content %}
<h1 style="text-align:center; color:#f8f8f2;">ðŸ“ˆ Simulation Dashboard</h1>

<div class="stats" style="display:flex; justify-content:center; gap:20px; margin-bottom:20px; color:#f8f8f2;">
  <div>Cash: ${{ simulation.cash }}</div>
  <div>Open Value: ${{ simulation.open }}</div>
  <div>Realized P&L: ${{ simulation.realized }}</div>
</div>

<div style="text-align:center; margin-bottom:20px;">
  <form action="{{ url_for('sim_reset') }}" method="post" style="display:inline;">
    <button type="submit" class="btn clear">Reset</button>
  </form>
</div>

<table class="alerts" style="width:100%; border-collapse:collapse; color:#f8f8f2;">
  <thead>
    <tr>
      <th>Symbol</th><th>Quantity</th><th>Avg Price</th><th>Current Price</th>
      <th>Current Value</th><th>P/L</th><th>% P/L</th><th>Clear</th>
    </tr>
  </thead>
  <tbody>
    {% for h in simulation.holdings %}
    <tr>
      <td>{{ h.symbol }}</td>
      <td>{{ h.quantity }}</td>
      <td>${{ '%.2f'|format(h.avg_price) }}</td>
      <td>${{ '%.2f'|format(h.current_price) }}</td>
      <td>${{ '%.2f'|format(h.current_value) }}</td>
      <td>${{ '%.2f'|format(h.profit_loss) }}</td>
      <td>{{ '%.2f'|format(h.profit_pct) }}%</td>
      <td>
        <form action="{{ url_for('clear_holding', symbol=h.symbol) }}" method="post" style="display:inline;">
          <button type="submit" class="btn btn-clear">X</button>
        </form>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<h2 style="text-align:center; margin-top:30px; color:#f8f8f2;">Trades</h2>
<table class="alerts" style="width:100%; border-collapse:collapse; color:#f8f8f2;">
  <thead>
    <tr>
      <th>Timestamp</th><th>Symbol</th><th>Action</th><th>Quantity</th><th>Price</th>
    </tr>
  </thead>
  <tbody>
    {% for t in simulation.trades %}
    <tr>
      <td>{{ t.timestamp }}</td>
      <td>{{ t.symbol }}</td>
      <td>{{ t.action }}</td>
      <td>{{ t.quantity }}</td>
      <td>${{ '%.2f'|format(t.price) }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
